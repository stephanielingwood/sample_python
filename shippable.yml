language: python

python:
  - 2.7

env:
  global:
    - TEST_VAR=reallyAwesomeString

build:
  ci:
    - pip install -r requirements.txt
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    - nosetests test.py --with-xunit --xunit-file=shippable/testresults/nosetests.xml
    - which python && coverage run --branch test.py
    - which python && coverage xml -o shippable/codecoverage/coverage.xml test.py
    - sleep 15

integrations:
  notifications:
    - integrationName: testOnStart
      type: webhook
      payload:
        - component=$REPO_NAME
        - version=$COMMIT
      on_success: never
      on_start: always
    - integrationName: testOnSuccess
      type: webhook
      payload:
        - component=$REPO_NAME
        - version=$COMMIT
        - myArray=["$COMMIT"]
        - success='single quotes actually work'
      on_success: always
      on_start: never
      on_failure: never
    # - integrationName: testOnFailure
    #   type: webhook
    #   payload:
    #     - component=$REPO_NAME
    #     - version=$COMMIT
    #     - failure=yeah
    #   on_success: never
    #   on_start: never
    #   on_failure: always
      
