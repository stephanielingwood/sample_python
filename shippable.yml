language: python

python:
  - 2.7

env:
  global:
    - TEST_VAR=reallyAwesomeString

install:
  - pip install -r requirements.txt

build:
  ci:  
    - mkdir -p shippable/testresults
    - mkdir -p shippable/codecoverage
    - nosetests test.py --with-xunit --xunit-file=shippable/testresults/nosetests.xml
    - which python && coverage run --branch test.py
    - which python && coverage xml -o shippable/codecoverage/coverage.xml test.py

integrations:
    notifications:
      - integrationName: stephWebhook
        type: webhook
        payload:
          - isPRBuild=$IS_PULL_REQUEST
          - branchName=$BRANCH
          - message=Shippable Run $BUILD_NUMBER ($BUILD_URL) succeeded for $COMPARE_URL
          - FOO=BAR
          - FIZZ=BUZZ
          - JOBNUMBER=$JOB_NUMBER
        branches:
          only:
            - notifications
        on_start: always            
        on_success: always
        on_failure: always
        on_pull_request: never
      - integrationName: stephSlack
        type: slack
        recipients:
          - "#slack_notifications"
          - "@stephanielingwood"
        branches:
          only:
           - notifications
       on_start: always
        on_success: always
        on_failure: always
     - integrationName: stephHipchat
        type: hipchat
        recipients:
          - "#Stephanie-test"
          - "@stephanietest"
        branches:
         only:
            - notifications
        on_start: always
        on_success: always
        on_failure: always        
      - integrationName: irc
        type: irc
        recipients:
          - "chat.freenode.net#eddyline2"        
          - "chat.freenode.net#eddyline1"        
 #         - "chat.freenode.net#eddyline2"
        branches:
          only:
            - notifications
        on_start: always
        on_success: always
        on_failure: always
      - integrationName: email
        type: email
        recipients:
         - stephanie@shippable.com
        branches:
          only:
            - notifications
        on_start: always
        on_success: always
        on_failure: always



